<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Urban Feet - Productos</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet"
        crossorigin="anonymous" />
    <!-- scripts -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="/JS/HeaderAdmin.js" type="text/javascript"></script>
    <script src="/JS/ProductosAdmin.js"></script>

    <!-- link -->
    <link rel="stylesheet" href="/CSS/ProductosAdmin.css">
    <link rel="stylesheet" href="/CSS/HeaderAdmin.css">

</head>

<body>
    <div th:replace="~{Admin/HeaderAdmin :: header}"></div>

    <div class="container mt-4">
        <!-- Encabezado -->
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h4 class="mb-0">Gestión de Productos</h4>
            <div class="btn-group">
                <button class="btn btn-dark" data-bs-toggle="modal"
                    data-bs-target="#modalRegistrarProducto">Registrar</button>
            </div>
        </div>

        <!-- Tabla de productos -->
        <div class="table-responsive">
            <table id="tablaProductos" class="table table-bordered table-hover align-middle text-center">
                <thead class="table-light">
                    <tr>
                        <th>ID</th>
                        <th>Nombre</th>
                        <th>Descripción</th>
                        <th>Marca</th>
                        <th>Género</th>
                        <th>Tipo</th>
                        <th>Colores</th>
                        <th>Precio</th>
                        <th>Stock</th>
                        <th>Acciones</th> <!-- Nueva columna -->
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="producto : ${productos}">
                        <td th:text="${producto.id}"></td>
                        <td th:text="${producto.nombre}"></td>
                        <td th:text="${producto.descripcion}"></td>
                        <td th:text="${producto.marca}"></td>
                        <td th:text="${producto.genero}"></td>
                        <td th:text="${producto.tipo}"></td>
                        <td th:text="${producto.colores}"></td>
                        <td th:text="'S/' + ${producto.precio}"></td>
                        <td th:text="${producto.stock}"></td>
                        <td>
                            <!-- Botón editar -->
                            <button class="btn btn-warning btn-sm" data-bs-toggle="modal"
                                data-bs-target="#modalEditarProducto" th:attr="data-id=${producto.id},
                                            data-nombre=${producto.nombre},
                                            data-descripcion=${producto.descripcion},
                                            data-marca=${producto.marca},
                                            data-genero=${producto.genero},
                                            data-tipo=${producto.tipo},
                                            data-colores=${producto.colores},
                                            data-precio=${producto.precio},
                                            data-stock=${producto.stock}" onclick="abrirModalEditar(this)">
                                Editar
                            </button>

                            <!-- Botón eliminar -->
                            <a th:href="@{'/admin/Productos/eliminar/' + ${producto.id}}" class="btn btn-danger btn-sm"
                                onclick="return confirm('¿Estás seguro de eliminar este producto?')">
                                Eliminar
                            </a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Modal Registrar -->
    <div class="modal fade" id="modalRegistrarProducto" tabindex="-1" aria-labelledby="modalRegistrarProductoLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content border-0 shadow">
                <div class="modal-header bg-dark text-white">
                    <h5 class="modal-title">Registrar Producto</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form th:action="@{/admin/Productos/registrar}" method="post" th:object="${producto}">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label>Nombre</label>
                                <input type="text" class="form-control" th:field="*{nombre}" />
                            </div>
                            <div class="col-md-6">
                                <label>Marca</label>
                                <input type="text" class="form-control" th:field="*{marca}" />
                            </div>
                            <div class="col-12">
                                <label>Descripción</label>
                                <textarea class="form-control" th:field="*{descripcion}" rows="2"></textarea>
                            </div>
                            <div class="col-md-4">
                                <label>Género</label>
                                <select class="form-select" th:field="*{genero}">
                                    <option value="" disabled selected>Seleccione género</option>
                                    <option value="Hombre">Hombre</option>
                                    <option value="Mujer">Mujer</option>
                                    <option value="Niño">Niño</option>
                                    <option value="Niña">Niña</option>
                                    <option value="Unisex">Unisex</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label>Tipo</label>
                                <select class="form-select" th:field="*{tipo}">
                                    <option value="" disabled selected>Seleccione tipo</option>
                                    <option value="Running">Running</option>
                                    <option value="Futbol">Futbol</option>
                                    <option value="Training">Training</option>
                                    <option value="Outdoor">Outdoor</option>
                                    <option value="Sneakers">Sneakers</option>
                                    <option value="Lifestyle">Lifestyle</option>
                                    <option value="Otros">Otros</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label>Colores</label>
                                <input type="text" class="form-control" th:field="*{colores}" />
                            </div>
                            <div class="col-md-6">
                                <label>Precio</label>
                                <input type="number" step="0.01" class="form-control" th:field="*{precio}" />
                            </div>
                            <div class="col-md-6">
                                <label>Stock</label>
                                <input type="number" class="form-control" th:field="*{stock}" />
                            </div>
                        </div>
                        <div class="modal-footer mt-4">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                            <button type="submit" class="btn btn-dark">Guardar</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Editar -->
    <div class="modal fade" id="modalEditarProducto" tabindex="-1" aria-labelledby="modalEditarProductoLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content border-0 shadow">
                <div class="modal-header bg-warning">
                    <h5 class="modal-title">Editar Producto</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form method="post" th:action="@{/admin/Productos/actualizar}">
                        <input type="hidden" name="id" id="edit-id" />
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label>Nombre</label>
                                <input type="text" class="form-control" name="nombre" id="edit-nombre" />
                            </div>
                            <div class="col-md-6">
                                <label>Marca</label>
                                <input type="text" class="form-control" name="marca" id="edit-marca" />
                            </div>
                            <div class="col-12">
                                <label>Descripción</label>
                                <textarea class="form-control" name="descripcion" id="edit-descripcion"
                                    rows="2"></textarea>
                            </div>
                            <div class="col-md-4">
                                <label>Género</label>
                                <select class="form-select" name="genero" id="edit-genero">
                                    <option>Hombre</option>
                                    <option>Mujer</option>
                                    <option>Niño</option>
                                    <option>Niña</option>
                                    <option>Unisex</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label>Tipo</label>
                                <select class="form-select" name="tipo" id="edit-tipo">
                                    <option>Running</option>
                                    <option>Futbol</option>
                                    <option>Training</option>
                                    <option>Outdoor</option>
                                    <option>Sneakers</option>
                                    <option>Lifestyle</option>
                                    <option>Otros</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label>Colores</label>
                                <input type="text" class="form-control" name="colores" id="edit-colores" />
                            </div>
                            <div class="col-md-6">
                                <label>Precio</label>
                                <input type="number" step="0.01" class="form-control" name="precio" id="edit-precio" />
                            </div>
                            <div class="col-md-6">
                                <label>Stock</label>
                                <input type="number" class="form-control" name="stock" id="edit-stock" />
                            </div>
                        </div>
                        <div class="modal-footer mt-4">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                            <button type="submit" class="btn btn-warning">Actualizar</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>